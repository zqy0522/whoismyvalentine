<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>valentine</title>
  <style>
    :root{
      --card:#ffffffcc;
      --shadow: 0 24px 80px rgba(0,0,0,.18);
      --text:#0b0b0b;
      --pink:#ff3b86;
      --grayBtn:#e9edf2;
    }
    *{box-sizing:border-box}
    html, body{height:auto}
    body{
      margin:0;
      min-height:100vh;
      display:block;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 800px at 20% 20%, #ffd2e0, transparent 55%),
        radial-gradient(1200px 800px at 80% 80%, #ffc1d6, transparent 55%),
        linear-gradient(135deg, #ffeaf2, #ffd6e6);
      color:var(--text);
      overflow-x:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      touch-action: manipulation;
    }
    .wrap{
      width:100%;
      max-width:1100px;
      margin:0 auto;
      padding:18px 14px 28px;
    }
    .card{
      width:100%;
      border-radius:38px;
      background:var(--card);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      padding:40px 34px 34px;
      text-align:center;
      position:relative;
    }

    /* top icon */
    .iconWrap{
      width:180px;
      height:180px;
      margin:0 auto 12px;
      filter: drop-shadow(0 18px 30px rgba(0,0,0,.18));
    }
    .iconWrap svg{width:100%;height:100%;display:block}

    h1{
      font-size: clamp(34px, 5.4vw, 72px);
      margin: 8px 0 10px;
      letter-spacing:-.02em;
      line-height:1.05;
      font-weight: 900;
    }

    .stage{
      position:relative;
      width:min(760px, 92vw);
      margin: 14px auto 8px;
      height:210px;
      border-radius:24px;
    }

    button{
      border:0;
      cursor:pointer;
      font-weight:900;
      border-radius:999px;
      transition: transform .08s ease, filter .15s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    button:active{transform: scale(.97)}

    /* YES = BIG */
    #yesBtn{
      z-index: 3;
      background: var(--pink);
      color:white;
      box-shadow: 0 18px 40px rgba(255,59,134,.35);
      position:absolute;
      left: 40%;
      top: 50%;
      transform: translate(-50%,-50%);
      font-size: 34px;
      padding: 26px 54px;
      min-width: 220px;
    }

    /* NO = SMALL */
    #noBtn{
      z-index: 2;
      background: var(--grayBtn);
      color:#111;
      position:absolute;
      left: 74%;
      top: 50%;
      transform: translate(-50%,-50%);
      box-shadow: 0 14px 32px rgba(0,0,0,.12);
      font-size: 16px;
      padding: 10px 18px;
      min-width: 74px;
    }

    /* YAY page */
    #yay{
      display:none;
      margin-top: 18px;
    }
    #yay h2{
      font-size: clamp(40px, 6vw, 78px);
      margin: 6px 0 16px;
      font-weight: 950;
      letter-spacing:-.02em;
    }

    /* slideshow */
    .slideshow{
      width:min(920px, 94vw);
      margin: 10px auto 0;
      background: rgba(255,255,255,.65);
      border-radius: 26px;
      padding: 14px 14px 18px;
      box-shadow: 0 16px 40px rgba(0,0,0,.12);
      position:relative;
      overflow:hidden;
    }

    .photoFrame{
      width:100%;
      border-radius: 18px;
      background: rgba(235,241,248,.7);
      overflow:hidden;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;

      /* key: responsive height so it works on phone + allows scroll */
      height: min(72vh, 620px);
      max-height: 620px;
    }
    .photoFrame img{
      width:100%;
      height:100%;
      object-fit: contain;
      display:block;
      user-select:none;
      -webkit-user-drag:none;
    }

    .slideNav{
      display:flex;
      justify-content:center;
      gap:12px;
      margin-top:12px;
      flex-wrap: wrap;
    }
    .navBtn{
      background:#111;
      color:#fff;
      font-weight:900;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 14px;
      opacity:.92;
    }
    .navBtn.secondary{
      background: rgba(17,17,17,.1);
      color:#111;
    }

    /* finale (shows on photo 43) */
    #finale{
      display:none;
      margin-top: 16px;
      padding: 18px 14px 14px;
      border-radius: 22px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 16px 44px rgba(0,0,0,.12);
    }
    #finale .big{
      font-size: clamp(20px, 3.2vw, 40px);
      font-weight: 950;
      margin: 0 0 8px;
      text-transform: uppercase;
      letter-spacing: .02em;
    }
    #finale .small{
      font-size: 18px;
      opacity:.9;
      margin: 0;
      font-weight: 800;
    }

    /* heartbreak */
    #heartbreak{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.52);
      align-items:center;
      justify-content:center;
      padding: 20px;
      z-index:9999;
    }
    .hbCard{
      width:min(780px, 92vw);
      background: rgba(255,255,255,.92);
      border-radius: 26px;
      padding: 26px 22px;
      box-shadow: 0 30px 90px rgba(0,0,0,.25);
      text-align:center;
    }
    .hbCard h3{
      margin:0 0 10px;
      font-size: clamp(24px, 3.4vw, 44px);
      font-weight: 950;
    }
    .hbCard p{
      margin:0;
      font-size: clamp(16px, 2.2vw, 22px);
      font-weight: 800;
    }
    .hbCard .close{
      margin-top: 16px;
      background: var(--pink);
      color: #fff;
      padding: 12px 18px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 900;
    }

    /* confetti canvas */
    #fx{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 8000;
    }

    @media (max-width: 520px){
      .card{ padding: 28px 18px 22px; border-radius: 26px; }
      .stage{ height: 240px; }
      #yesBtn{
        font-size: 28px;
        padding: 22px 44px;
        min-width: 200px;
        left: 38%;
      }
      #noBtn{
        font-size: 15px;
        padding: 9px 16px;
        min-width: 70px;
        left: 76%;
      }
      .slideshow{ padding: 12px 12px 14px; }
      .photoFrame{ height: min(60vh, 520px); }
    }
  </style>
</head>

<body>
  <canvas id="fx"></canvas>

  <div class="wrap">
    <div class="card">
      <div class="iconWrap" aria-hidden="true">
        <!-- cute bird -->
        <svg viewBox="0 0 200 200">
          <defs>
            <radialGradient id="g" cx="35%" cy="35%" r="70%">
              <stop offset="0" stop-color="#ffe2cf"/>
              <stop offset="1" stop-color="#ffb78d"/>
            </radialGradient>
          </defs>
          <circle cx="100" cy="105" r="78" fill="url(#g)"/>
          <circle cx="76" cy="92" r="9" fill="#111"/>
          <circle cx="124" cy="92" r="9" fill="#111"/>
          <path d="M100 106c10 8 10 18 0 26c-10-8-10-18 0-26z" fill="#ff6aa8"/>
          <path d="M64 62c18 0 26 10 30 26c-18-2-30-10-30-26z" fill="#f4b7c7" opacity=".95"/>
          <path d="M136 62c-18 0-26 10-30 26c18-2 30-10 30-26z" fill="#f4b7c7" opacity=".95"/>
          <path d="M140 40c18 0 28 10 28 28c-18 2-28-10-28-28z" fill="#ff3b86" opacity=".92"/>
        </svg>
      </div>

      <h1>Kubie will you be my valentine?</h1>

      <div class="stage" id="stage">
        <button id="yesBtn">Yes</button>
        <button id="noBtn">No</button>
      </div>

      <div id="yay">
        <h2>YAY! ðŸŽ‰ðŸ˜šðŸ’–</h2>

        <div class="slideshow" id="slideshow">
          <div class="photoFrame">
            <img id="slideImg" src="" alt="slideshow photo" />
          </div>
          <div class="slideNav">
            <button class="navBtn secondary" id="prevBtn">Prev</button>
            <button class="navBtn" id="nextBtn">Next</button>
          </div>
        </div>

        <div id="finale">
          <div class="big">HAPPY VALENTINES MY CUTIE! READY FOR OUR FANCY DATIES?</div>
          <div class="small">Now come here ðŸ’˜</div>
        </div>
      </div>
    </div>
  </div>

  <div id="heartbreak">
    <div class="hbCard">
      <h3>ðŸ’” Girlfriend heartbroken</h3>
      <p>Give girlfriend a bit huggie right now!!</p>
      <button class="close" id="hbClose">Ok ok ðŸ˜¤</button>
    </div>
  </div>

  <script>
    // ====== Photo list (EXACTLY 43 photos) ======
    function generatePhotos(n, prefix="photo", ext=".jpg"){
      const arr = [];
      for (let i=1;i<=n;i++){
        const num = String(i).padStart(2,"0");
        arr.push(`${prefix}${num}${ext}`);
      }
      return arr;
    }
    const PHOTOS = generatePhotos(43, "photo", ".jpg");

    // ====== Elements ======
    const stage = document.getElementById("stage");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn  = document.getElementById("noBtn");
    const yay = document.getElementById("yay");

    const slideImg = document.getElementById("slideImg");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const finale = document.getElementById("finale");

    const heartbreak = document.getElementById("heartbreak");
    const hbClose = document.getElementById("hbClose");

    // ====== NO button movement (timer-based) ======
    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }

    function setNoCenter(clientX, clientY){
      const rect = stage.getBoundingClientRect();
      const btnW = noBtn.offsetWidth;
      const btnH = noBtn.offsetHeight;
      const x = clamp(clientX - rect.left - btnW/2, 8, rect.width  - btnW - 8);
      const y = clamp(clientY - rect.top  - btnH/2, 8, rect.height - btnH - 8);
      noBtn.style.left = `${x + btnW/2}px`;
      noBtn.style.top  = `${y + btnH/2}px`;
    }

    function randomWithinStage(){
      const rect = stage.getBoundingClientRect();
      const btnW = noBtn.offsetWidth;
      const btnH = noBtn.offsetHeight;
      const pad = 10;

      const x = rect.left + pad + Math.random() * Math.max(0, rect.width - btnW - pad * 2);
      const y = rect.top  + pad + Math.random() * Math.max(0, rect.height - btnH - pad * 2);

      setNoCenter(x, y);
    }

    const MOVE_INTERVAL_MS = 420; // decently fast but still clickable
    let moveTimer = null;

    function startNoDance(){
      stopNoDance();
      setTimeout(randomWithinStage, 60);
      moveTimer = setInterval(randomWithinStage, MOVE_INTERVAL_MS);
    }
    function stopNoDance(){
      if (moveTimer){
        clearInterval(moveTimer);
        moveTimer = null;
      }
    }

    // Start immediately, AND also re-start on first interaction (some mobile webviews throttle timers)
    startNoDance();
    document.addEventListener("pointerdown", () => startNoDance(), { passive:true, once:true });

    window.addEventListener("resize", () => {
      if (yay.style.display !== "block") randomWithinStage();
    }, { passive: true });

    // ====== Heartbreak if NO is clicked ======
    noBtn.addEventListener("click", (e) => {
      e.preventDefault();
      heartbreak.style.display = "flex";
    });
    hbClose.addEventListener("click", () => {
      heartbreak.style.display = "none";
    });

    // ====== YES click -> show yay + start slideshow ======
    yesBtn.addEventListener("click", (e) => {
      e.preventDefault();
      stopNoDance();
      stage.style.display = "none";
      yay.style.display = "block";
      startSlideshow();
    });

    // ====== Slideshow (stops at photo 43, then shows finale + confetti) ======
    let slideIdx = 0;
    let autoTimer = null;
    let finaleTriggered = false;

    function renderSlide(){
      slideImg.src = PHOTOS[slideIdx];
    }

    function showFinaleOnce(){
      if (finaleTriggered) return;
      finaleTriggered = true;
      finale.style.display = "block";
      burstFireworks(); // confetti/fireworks at END (photo 43)
    }

    function nextSlide(){
      // if we're already at last photo, do nothing
      if (slideIdx >= PHOTOS.length - 1){
        showFinaleOnce();
        clearInterval(autoTimer);
        autoTimer = null;
        return;
      }

      slideIdx++;
      renderSlide();

      // if we just reached last photo, trigger finale and stop
      if (slideIdx === PHOTOS.length - 1){
        showFinaleOnce();
        clearInterval(autoTimer);
        autoTimer = null;
      }
    }

    function prevSlide(){
      if (slideIdx <= 0) {
        slideIdx = 0;
      } else {
        slideIdx--;
      }
      renderSlide();
    }

    prevBtn.addEventListener("click", () => prevSlide());
    nextBtn.addEventListener("click", () => nextSlide());

    function startSlideshow(){
      slideIdx = 0;
      finaleTriggered = false;
      finale.style.display = "none";
      renderSlide();

      clearInterval(autoTimer);
      autoTimer = setInterval(nextSlide, 1000); // 1 second per photo
    }

    // ====== Fireworks / confetti ======
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d");
    let W=0,H=0;

    function resize(){
      W = canvas.width = window.innerWidth * devicePixelRatio;
      H = canvas.height = window.innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    window.addEventListener("resize", resize, {passive:true});
    resize();

    const particles = [];
    function spawnBurst(x,y, count=110){
      for(let i=0;i<count;i++){
        const ang = Math.random()*Math.PI*2;
        const spd = 2 + Math.random()*6;
        particles.push({
          x,y,
          vx: Math.cos(ang)*spd,
          vy: Math.sin(ang)*spd,
          life: 70 + Math.random()*55,
          r: 2 + Math.random()*3,
          hue: Math.random()*360
        });
      }
    }

    function tick(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.life -= 1;
        p.vy += 0.07;
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.98;
        p.vy *= 0.98;

        const a = Math.max(0, Math.min(1, p.life/120));
        ctx.globalAlpha = a;
        ctx.beginPath();
        ctx.fillStyle = `hsl(${p.hue}, 90%, 60%)`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();

        if (p.life <= 0) particles.splice(i,1);
      }
      ctx.globalAlpha = 1;
      requestAnimationFrame(tick);
    }
    tick();

    function burstFireworks(){
      const rect = document.querySelector(".card").getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + 140;

      spawnBurst(cx, cy, 140);
      setTimeout(() => spawnBurst(cx-170, cy+40, 110), 180);
      setTimeout(() => spawnBurst(cx+180, cy+30, 110), 320);
      setTimeout(() => spawnBurst(cx, cy+120, 140), 540);
    }
  </script>
</body>
</html>
